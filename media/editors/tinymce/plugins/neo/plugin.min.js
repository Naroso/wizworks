/**
 * plugin.js
 *
 * Released under LGPL License.
 * Copyright (c) 1999-2015 Ephox Corp. All rights reserved
 *
 * License: http://www.tinymce.com/license
 * Contributing: http://www.tinymce.com/contributing
 */

/*global tinymce:true */

tinymce.PluginManager.add('neo', function (editor) {
    console.log('noe');
    // Inside plugin
    editor.addMenuItem('myMenuItem', {
        text: 'My Menu Item',
        context: 'div', // not sure what this does
        onPostRender: postRender,
        onclick: function () {
            console.log('hi!');
        }
    });

// Determine whether menu item is visible
    function postRender() {
        handleDisabledState(this, 'div.myCustomItem');
    }

    function handleDisabledState(ctrl, selector) {
        function bindStateListener() {
            ctrl.visible(editor.dom.getParent(editor.selection.getStart(), selector));
            editor.selection.selectorChanged(selector, function (state) {
                ctrl.visible(state);
            });
        }

        if (editor.initialized)
            bindStateListener();
        else
            editor.on('init', bindStateListener);
    }
});